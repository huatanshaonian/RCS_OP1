# RCS预测模型系统使用说明文档

## 系统概述

本系统使用机器学习方法建立飞行器设计参数与雷达散射截面(RCS)之间的预测模型，包含数据处理、模型训练与预测应用三个主要模块。系统实现了克里金模型(高斯过程回归)和多项式回归两种方法，能够准确预测给定设计参数下的RCS值，并提供敏感度分析与设计优化功能。

## 文件结构

系统包含以下主要脚本文件：

1. `data_loading.py` - 数据加载与处理模块
2. `model_training.py` - 模型训练模块
3. `model_prediction.py` - 模型预测应用模块

## 数据文件要求

系统需要以下两个CSV文件：

1. **statistics_3G.csv**：
   - 包含模型编号(model_id)和对应的RCS均值
   - 第一行为列名
   - 第一列为model_id(整数)，第二列为RCS值(dBsm单位)

2. **parameter_sorted.csv**：
   - 包含设计参数数据
   - 第一行为参数名称
   - 按model_id顺序排列(第一行对应model_id=1，第二行对应model_id=2，依此类推)
   - 不包含model_id列

## 使用流程

### 1. 数据加载与处理

首先运行数据加载脚本，将RCS数据与设计参数数据匹配：

```bash
python correct_data_loading.py
```

此脚本会：
- 加载RCS数据和参数数据
- 基于model_id匹配两个数据集
- 生成'matched_rcs_data.csv'文件
- 显示数据统计信息

### 2. 模型训练

使用匹配好的数据训练预测模型：

```bash
python model_training_with_corrected_data.py
```

此脚本会：
- 加载匹配后的数据
- 标准化设计参数
- 训练克里金模型和多项式回归模型
- 评估和比较两种模型的性能
- 生成性能比较图表
- 分析特征重要性
- 将模型保存为'rcs_prediction_models.pkl'

### 3. 模型预测与应用

使用训练好的模型进行预测和分析：

```bash
python model_prediction_script.py
```

此脚本提供以下功能：
- 预测新设计参数的RCS值
- 比较多个设计方案
- 进行参数敏感度分析
- 探索设计空间寻找最优设计
- 生成参数响应曲面可视化

## 主要功能详解

### 1. 数据处理功能

- **数据匹配**：基于model_id将RCS数据与参数数据正确匹配
- **数据验证**：检查model_id有效性，确保匹配正确
- **数据标准化**：将设计参数转换到相同尺度
- **缺失值处理**：检测并处理可能的缺失值

### 2. 模型训练功能

- **克里金模型(高斯过程回归)**：
  - 使用Matérn核函数，适合工程领域的非光滑函数
  - 自动优化核函数参数
  - 提供预测不确定性估计

- **多项式回归模型**：
  - 自动选择最优多项式阶数(1-3阶)
  - 使用交叉验证评估模型

- **模型评估**：
  - 计算均方根误差(RMSE)和决定系数(R²)
  - 使用交叉验证评估泛化性能
  - 可视化比较模型性能

### 3. 模型应用功能

- **RCS预测**：
  - 预测给定设计参数的RCS值
  - 提供预测不确定性(克里金模型)

- **敏感度分析**：
  - 确定哪些设计参数对RCS影响最大
  - 生成参数扫描曲线，展示参数变化对RCS的影响

- **设计空间探索**：
  - 在参数空间中随机采样
  - 寻找RCS最小或接近目标值的设计方案

- **响应曲面分析**：
  - 生成两个参数的RCS响应曲面
  - 提供2D等高线图和3D曲面图

## 输出文件

系统会生成以下输出文件：

1. **数据处理输出**：
   - `matched_rcs_data.csv` - 匹配后的完整数据

2. **模型训练输出**：
   - `model_comparison.png` - 模型性能比较图
   - `kriging_uncertainty.png` - 克里金模型不确定性可视化
   - `feature_importance.png` - 特征重要性分析图
   - `rcs_prediction_models.pkl` - 保存的模型文件

3. **模型应用输出**：
   - `sensitivity_ranking.png` - 参数敏感度排序图
   - `parameter_scan_curves.png` - 参数扫描曲线
   - `response_surface_*.png` - 参数响应曲面图

## 扩展与更新

1. **添加新数据**：
   - 向statistics_3G.csv添加新的模型RCS数据
   - 确保parameter_sorted.csv中有对应的参数数据
   - 重新运行完整流程以更新模型

2. **修改参数范围**：
   - 在model_prediction_script.py中修改param_ranges字典

3. **自定义敏感度分析**：
   - 修改design_params字典设置基准设计
   - 调整n_points参数控制分析精度

## 注意事项

1. RCS值已经是dBsm单位(对数尺度)，无需再次进行对数变换
2. 在添加新数据时，确保model_id连续且正确对应parameter_sorted.csv中的行
3. 保存的模型依赖于训练时的特征名称，确保预测时使用相同的特征名称

## 示例用法

参见各脚本末尾的example_usage()或main()函数，展示了如何调用各个模块的功能，以及如何根据实际需求进行自定义。